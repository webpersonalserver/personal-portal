import{S as I,P as G,W,B as Z,d as R,a as $,A as D,b as j,C as y}from"./three.module-DH32k5fD.js";import{_ as q,r as N,a as U,n as V,h as S,c as T,d as A,F as J,e as K,o as F,f as O}from"./index-JhRrNsYt.js";const Q={class:"portal-pages-experiment-container"},z={class:"floating-hearts"},ee={__name:"Experiment",setup(te){const h=N(null);let C=null,p=null,i=null,g=null,x=null;const v=[16717636,16739229,16728193,15277667,12720219,16716947,16738740,16761035],Y=(a,e,t,n)=>{a.beginPath();const r=n*.3;a.moveTo(e,t+r),a.bezierCurveTo(e,t,e-n/2,t,e-n/2,t+r),a.bezierCurveTo(e-n/2,t+n*.7,e,t+n*.9,e,t+n),a.bezierCurveTo(e,t+n*.9,e+n/2,t+n*.7,e+n/2,t+r),a.bezierCurveTo(e+n/2,t,e,t,e,t+r),a.closePath()},E=(a,e,t=0,n=0,r=350)=>{const c=document.createElement("canvas"),w=c.getContext("2d");c.width=r*2,c.height=r*2,Y(w,r,r,r);const M=r+(a-t),o=r+(e-n);return w.isPointInPath(M,o)},L=(a=15e3)=>{const e=new Float32Array(a*3),t=new Float32Array(a*3),n=350,r=0,c=0,w=n/2,M=n;let o=0,d=0;const m=a*15,u=5,B=[],_=r-w,P=c-M/2;for(let s=P;s<P+n;s+=u)for(let l=_;l<_+n;l+=u)E(l,s,r,c,n)&&B.push({x:l,y:s});for(let s=0;s<Math.min(B.length,a*.8);s++){const l=B[s],b=(Math.random()-.5)*u*.6,f=(Math.random()-.5)*u*.6,H=(Math.random()-.5)*2;e[o*3]=l.x+b,e[o*3+1]=-(l.y+f),e[o*3+2]=H;const k=new y(v[Math.floor(Math.random()*v.length)]);t[o*3]=k.r,t[o*3+1]=k.g,t[o*3+2]=k.b,o++}for(;o<a&&d<m;){d++;const s=_+Math.random()*n,l=P+Math.random()*n;if(E(s,l,r,c,n)){const b=(Math.random()-.5)*2;e[o*3]=s,e[o*3+1]=-l,e[o*3+2]=b;const f=new y(v[Math.floor(Math.random()*v.length)]);t[o*3]=f.r,t[o*3+1]=f.g,t[o*3+2]=f.b,o++}}for(;o<a&&d<m*2;){d++;const s=_+Math.random()*n,l=P+Math.random()*n;if(E(s,l,r,c,n)){const b=(Math.random()-.5)*2;e[o*3]=s,e[o*3+1]=-l,e[o*3+2]=b;const f=new y(v[Math.floor(Math.random()*v.length)]);t[o*3]=f.r,t[o*3+1]=f.g,t[o*3+2]=f.b,o++}}return{positions:e,colors:t}},X=()=>{if(!h.value){console.error("Container ref is null");return}C=new I,C.background=null;const a=h.value.getBoundingClientRect(),e=a.width||800,t=a.height||800;console.log("Container size:",e,t),p=new G(75,e/t,.1,1e3),p.position.set(0,0,400),i=new W({antialias:!0,alpha:!0}),i.setSize(e,t),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),i.setClearColor(0,0),i.domElement.style.display="block",h.value.appendChild(i.domElement);const{positions:n,colors:r}=L(15e3);console.log("Generated particles:",n.length/3);const c=new Z;c.setAttribute("position",new R(n,3)),c.setAttribute("color",new R(r,3));const w=new $({size:2,vertexColors:!0,transparent:!0,opacity:1,blending:D,depthWrite:!1,sizeAttenuation:!0});g=new j(c,w),C.add(g),console.log("Particles added to scene");const M=()=>{x=requestAnimationFrame(M);const d=Date.now()*.001,m=1+Math.sin(d*2)*.05;g.scale.set(m,m,m),p.lookAt(0,0,0),i.render(C,p)};M();const o=()=>{if(!h.value)return;const d=h.value.getBoundingClientRect(),m=d.width||800,u=d.height||800;p.aspect=m/u,p.updateProjectionMatrix(),i.setSize(m,u)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}};return U(()=>{V(()=>{window.setTimeout(()=>{const a=X();a&&S(()=>{a()})},100)})}),S(()=>{if(x&&cancelAnimationFrame(x),i&&i.dispose(),g&&(g.geometry.dispose(),g.material.dispose()),h.value&&i&&i.domElement)try{h.value.removeChild(i.domElement)}catch(a){console.warn("Error removing renderer:",a)}}),(a,e)=>(F(),T("div",Q,[A("div",z,[(F(),T(J,null,K(20,t=>A("span",{key:t,class:"floating-heart",style:O({left:`${Math.random()*100}%`,animationDelay:`${Math.random()*5}s`,fontSize:`${15+Math.random()*10}px`})}," ‚ù§Ô∏è ",4)),64))]),A("div",{ref_key:"containerRef",ref:h,class:"heart-container"},null,512),e[0]||(e[0]=A("div",{class:"romantic-text"},"Love You Forever üíï",-1))]))}},ae=q(ee,[["__scopeId","data-v-72905f9f"]]);export{ae as default};
